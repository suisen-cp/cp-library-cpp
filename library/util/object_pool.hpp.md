---
data:
  _extendedDependsOn: []
  _extendedRequiredBy:
  - icon: ':warning:'
    path: library/datastructure/bbst/persistent_red_black_lazy_segment_tree.hpp
    title: "\u533A\u9593\u4F5C\u7528\u30FB\u533A\u9593\u548C\u53D6\u5F97\u304C\u53EF\
      \u80FD\u306A\u6C38\u7D9A\u8D64\u9ED2\u6728"
  - icon: ':warning:'
    path: library/datastructure/bbst/persistent_red_black_reversible_lazy_segment_tree.hpp
    title: "\u53CD\u8EE2\u30FB\u533A\u9593\u4F5C\u7528\u30FB\u533A\u9593\u548C\u53D6\
      \u5F97\u304C\u53EF\u80FD\u306A\u6C38\u7D9A\u8D64\u9ED2\u6728"
  - icon: ':warning:'
    path: library/datastructure/bbst/persistent_red_black_segment_tree.hpp
    title: "\u533A\u9593\u548C\u53D6\u5F97\u304C\u53EF\u80FD\u306A\u6C38\u7D9A\u8D64\
      \u9ED2\u6728"
  - icon: ':warning:'
    path: library/datastructure/bbst/persistent_red_black_tree.hpp
    title: "\u6C38\u7D9A\u8D64\u9ED2\u6728"
  - icon: ':warning:'
    path: library/datastructure/bbst/persistent_red_black_tree_base.hpp
    title: Persistent Red Black Tree Base
  - icon: ':heavy_check_mark:'
    path: library/datastructure/bbst/red_black_lazy_segment_tree.hpp
    title: "\u533A\u9593\u4F5C\u7528\u30FB\u533A\u9593\u548C\u53D6\u5F97\u304C\u53EF\
      \u80FD\u306A\u8D64\u9ED2\u6728"
  - icon: ':heavy_check_mark:'
    path: library/datastructure/bbst/red_black_reversible_lazy_segment_tree.hpp
    title: "\u53CD\u8EE2\u30FB\u533A\u9593\u4F5C\u7528\u30FB\u533A\u9593\u548C\u53D6\
      \u5F97\u304C\u53EF\u80FD\u306A\u8D64\u9ED2\u6728"
  - icon: ':heavy_check_mark:'
    path: library/datastructure/bbst/red_black_segment_tree.hpp
    title: "\u533A\u9593\u548C\u53D6\u5F97\u304C\u53EF\u80FD\u306A\u8D64\u9ED2\u6728"
  - icon: ':heavy_check_mark:'
    path: library/datastructure/bbst/red_black_tree.hpp
    title: "\u8D64\u9ED2\u6728"
  - icon: ':heavy_check_mark:'
    path: library/datastructure/bbst/red_black_tree_base.hpp
    title: Red Black Tree Base
  - icon: ':heavy_check_mark:'
    path: library/datastructure/fenwick_tree/persistent_fenwick_tree.hpp
    title: Persistent Fenwick Tree
  - icon: ':heavy_check_mark:'
    path: library/datastructure/persistent_array.hpp
    title: "\u6C38\u7D9A\u914D\u5217"
  - icon: ':heavy_check_mark:'
    path: library/datastructure/segment_tree/persistent_commutative_dual_segment_tree.hpp
    title: Persistent Commutative Dual Segment Tree
  - icon: ':heavy_check_mark:'
    path: library/datastructure/segment_tree/persistent_dual_segment_tree.hpp
    title: Persistent Dual Segment Tree
  - icon: ':heavy_check_mark:'
    path: library/datastructure/segment_tree/persistent_lazy_segment_tree.hpp
    title: "\u6C38\u7D9A\u9045\u5EF6\u4F1D\u64AD\u30BB\u30B0\u30E1\u30F3\u30C8\u6728"
  - icon: ':heavy_check_mark:'
    path: library/datastructure/segment_tree/persistent_segment_tree.hpp
    title: "\u6C38\u7D9A\u30BB\u30B0\u30E1\u30F3\u30C8\u6728"
  - icon: ':heavy_check_mark:'
    path: library/datastructure/union_find/persistent_union_find.hpp
    title: "\u6C38\u7D9A Union Find"
  - icon: ':warning:'
    path: library/string/dynamic_rolling_hash.hpp
    title: Dynamic Rolling Hash
  - icon: ':heavy_check_mark:'
    path: library/tree/link_cut_tree.hpp
    title: Link Cut Tree
  - icon: ':heavy_check_mark:'
    path: library/tree/link_cut_tree_base.hpp
    title: Link Cut Tree Base
  - icon: ':heavy_check_mark:'
    path: library/tree/link_cut_tree_path_foldable.hpp
    title: "\u30D1\u30B9\u548C\u53D6\u5F97\u304C\u3067\u304D\u308B Link Cut Tree"
  - icon: ':heavy_check_mark:'
    path: library/tree/link_cut_tree_path_foldable_lazy.hpp
    title: "\u30D1\u30B9\u548C\u53D6\u5F97\u30FB\u30D1\u30B9\u4F5C\u7528\u304C\u3067\
      \u304D\u308B Link Cut Tree"
  _extendedVerifiedWith:
  - icon: ':heavy_check_mark:'
    path: test/src/datastructure/bbst/red_black_lazy_segment_tree/dynamic_sequence_range_affine_range_sum.test.cpp
    title: test/src/datastructure/bbst/red_black_lazy_segment_tree/dynamic_sequence_range_affine_range_sum.test.cpp
  - icon: ':heavy_check_mark:'
    path: test/src/datastructure/bbst/red_black_reversible_lazy_segment_tree/dynamic_sequence_range_affine_range_sum.test.cpp
    title: test/src/datastructure/bbst/red_black_reversible_lazy_segment_tree/dynamic_sequence_range_affine_range_sum.test.cpp
  - icon: ':heavy_check_mark:'
    path: test/src/datastructure/bbst/red_black_segment_tree/abc238_f.test.cpp
    title: test/src/datastructure/bbst/red_black_segment_tree/abc238_f.test.cpp
  - icon: ':heavy_check_mark:'
    path: test/src/datastructure/bbst/red_black_tree/abc237_d.test.cpp
    title: test/src/datastructure/bbst/red_black_tree/abc237_d.test.cpp
  - icon: ':heavy_check_mark:'
    path: test/src/datastructure/fenwick_tree/persistent_fenwick_tree/abc253_f.test.cpp
    title: test/src/datastructure/fenwick_tree/persistent_fenwick_tree/abc253_f.test.cpp
  - icon: ':heavy_check_mark:'
    path: test/src/datastructure/fenwick_tree/persistent_fenwick_tree/rectangle_sum.test.cpp
    title: test/src/datastructure/fenwick_tree/persistent_fenwick_tree/rectangle_sum.test.cpp
  - icon: ':heavy_check_mark:'
    path: test/src/datastructure/segment_tree/persistent_commutative_dual_segment_tree/abc253.test.cpp
    title: test/src/datastructure/segment_tree/persistent_commutative_dual_segment_tree/abc253.test.cpp
  - icon: ':heavy_check_mark:'
    path: test/src/datastructure/segment_tree/persistent_dual_segment_tree/abc253.test.cpp
    title: test/src/datastructure/segment_tree/persistent_dual_segment_tree/abc253.test.cpp
  - icon: ':heavy_check_mark:'
    path: test/src/datastructure/segment_tree/persistent_lazy_segment_tree/abc253.test.cpp
    title: test/src/datastructure/segment_tree/persistent_lazy_segment_tree/abc253.test.cpp
  - icon: ':heavy_check_mark:'
    path: test/src/datastructure/segment_tree/persistent_lazy_segment_tree/dummy.test.cpp
    title: test/src/datastructure/segment_tree/persistent_lazy_segment_tree/dummy.test.cpp
  - icon: ':heavy_check_mark:'
    path: test/src/datastructure/segment_tree/persistent_segment_tree/abc253_f.test.cpp
    title: test/src/datastructure/segment_tree/persistent_segment_tree/abc253_f.test.cpp
  - icon: ':heavy_check_mark:'
    path: test/src/datastructure/segment_tree/persistent_segment_tree/dummy.test.cpp
    title: test/src/datastructure/segment_tree/persistent_segment_tree/dummy.test.cpp
  - icon: ':heavy_check_mark:'
    path: test/src/datastructure/segment_tree/persistent_segment_tree/rectangle_sum.test.cpp
    title: test/src/datastructure/segment_tree/persistent_segment_tree/rectangle_sum.test.cpp
  - icon: ':heavy_check_mark:'
    path: test/src/datastructure/union_find/persistent_union_find/persistent_unionfind.test.cpp
    title: test/src/datastructure/union_find/persistent_union_find/persistent_unionfind.test.cpp
  - icon: ':heavy_check_mark:'
    path: test/src/tree/link_cut_tree/lca.test.cpp
    title: test/src/tree/link_cut_tree/lca.test.cpp
  - icon: ':heavy_check_mark:'
    path: test/src/tree/link_cut_tree_path_foldable/dummy1.test.cpp
    title: test/src/tree/link_cut_tree_path_foldable/dummy1.test.cpp
  - icon: ':heavy_check_mark:'
    path: test/src/tree/link_cut_tree_path_foldable/dynamic_tree_vertex_add_path_sum.test.cpp
    title: test/src/tree/link_cut_tree_path_foldable/dynamic_tree_vertex_add_path_sum.test.cpp
  - icon: ':heavy_check_mark:'
    path: test/src/tree/link_cut_tree_path_foldable/dynamic_tree_vertex_set_path_composite.test.cpp
    title: test/src/tree/link_cut_tree_path_foldable/dynamic_tree_vertex_set_path_composite.test.cpp
  - icon: ':heavy_check_mark:'
    path: test/src/tree/link_cut_tree_path_foldable/lca.test.cpp
    title: test/src/tree/link_cut_tree_path_foldable/lca.test.cpp
  - icon: ':heavy_check_mark:'
    path: test/src/tree/link_cut_tree_path_foldable_lazy/GRL_5_E.test.cpp
    title: test/src/tree/link_cut_tree_path_foldable_lazy/GRL_5_E.test.cpp
  - icon: ':heavy_check_mark:'
    path: test/src/tree/link_cut_tree_path_foldable_lazy/dummy1.test.cpp
    title: test/src/tree/link_cut_tree_path_foldable_lazy/dummy1.test.cpp
  - icon: ':heavy_check_mark:'
    path: test/src/tree/link_cut_tree_path_foldable_lazy/yuki399.test.cpp
    title: test/src/tree/link_cut_tree_path_foldable_lazy/yuki399.test.cpp
  _isVerificationFailed: false
  _pathExtension: hpp
  _verificationStatusIcon: ':heavy_check_mark:'
  attributes:
    links: []
  bundledCode: "#line 1 \"library/util/object_pool.hpp\"\n\n\n\n#include <deque>\n\
    #include <vector>\n\nnamespace suisen {\n    template <typename T, bool auto_extend\
    \ = false>\n    struct ObjectPool {\n        using value_type = T;\n        using\
    \ value_pointer_type = T*;\n\n        template <typename U>\n        using container_type\
    \ = std::conditional_t<auto_extend, std::deque<U>, std::vector<U>>;\n\n      \
    \  container_type<value_type> pool;\n        container_type<value_pointer_type>\
    \ stock;\n        decltype(stock.begin()) it;\n\n        ObjectPool() : ObjectPool(0)\
    \ {}\n        ObjectPool(int siz) : pool(siz), stock(siz) {\n            clear();\n\
    \        }\n\n        int capacity() const { return pool.size(); }\n        int\
    \ size() const { return it - stock.begin(); }\n\n        value_pointer_type alloc()\
    \ {\n            if constexpr (auto_extend) ensure();\n            return *it++;\n\
    \        }\n\n        void free(value_pointer_type t) {\n            *--it = t;\n\
    \        }\n\n        void clear() {\n            int siz = pool.size();\n   \
    \         it = stock.begin();\n            for (int i = 0; i < siz; i++) stock[i]\
    \ = &pool[i];\n        }\n\n        void ensure() {\n            if (it != stock.end())\
    \ return;\n            int siz = stock.size();\n            for (int i = siz;\
    \ i <= siz * 2; ++i) {\n                stock.push_back(&pool.emplace_back());\n\
    \            }\n            it = stock.begin() + siz;\n        }\n    };\n} //\
    \ namespace suisen\n\n\n"
  code: "#ifndef SUISEN_OBJECT_POOL\n#define SUISEN_OBJECT_POOL\n\n#include <deque>\n\
    #include <vector>\n\nnamespace suisen {\n    template <typename T, bool auto_extend\
    \ = false>\n    struct ObjectPool {\n        using value_type = T;\n        using\
    \ value_pointer_type = T*;\n\n        template <typename U>\n        using container_type\
    \ = std::conditional_t<auto_extend, std::deque<U>, std::vector<U>>;\n\n      \
    \  container_type<value_type> pool;\n        container_type<value_pointer_type>\
    \ stock;\n        decltype(stock.begin()) it;\n\n        ObjectPool() : ObjectPool(0)\
    \ {}\n        ObjectPool(int siz) : pool(siz), stock(siz) {\n            clear();\n\
    \        }\n\n        int capacity() const { return pool.size(); }\n        int\
    \ size() const { return it - stock.begin(); }\n\n        value_pointer_type alloc()\
    \ {\n            if constexpr (auto_extend) ensure();\n            return *it++;\n\
    \        }\n\n        void free(value_pointer_type t) {\n            *--it = t;\n\
    \        }\n\n        void clear() {\n            int siz = pool.size();\n   \
    \         it = stock.begin();\n            for (int i = 0; i < siz; i++) stock[i]\
    \ = &pool[i];\n        }\n\n        void ensure() {\n            if (it != stock.end())\
    \ return;\n            int siz = stock.size();\n            for (int i = siz;\
    \ i <= siz * 2; ++i) {\n                stock.push_back(&pool.emplace_back());\n\
    \            }\n            it = stock.begin() + siz;\n        }\n    };\n} //\
    \ namespace suisen\n\n#endif // SUISEN_OBJECT_POOL\n"
  dependsOn: []
  isVerificationFile: false
  path: library/util/object_pool.hpp
  requiredBy:
  - library/string/dynamic_rolling_hash.hpp
  - library/tree/link_cut_tree_base.hpp
  - library/tree/link_cut_tree_path_foldable.hpp
  - library/tree/link_cut_tree_path_foldable_lazy.hpp
  - library/tree/link_cut_tree.hpp
  - library/datastructure/fenwick_tree/persistent_fenwick_tree.hpp
  - library/datastructure/persistent_array.hpp
  - library/datastructure/union_find/persistent_union_find.hpp
  - library/datastructure/bbst/red_black_tree_base.hpp
  - library/datastructure/bbst/persistent_red_black_tree.hpp
  - library/datastructure/bbst/red_black_reversible_lazy_segment_tree.hpp
  - library/datastructure/bbst/red_black_tree.hpp
  - library/datastructure/bbst/red_black_segment_tree.hpp
  - library/datastructure/bbst/persistent_red_black_segment_tree.hpp
  - library/datastructure/bbst/red_black_lazy_segment_tree.hpp
  - library/datastructure/bbst/persistent_red_black_reversible_lazy_segment_tree.hpp
  - library/datastructure/bbst/persistent_red_black_lazy_segment_tree.hpp
  - library/datastructure/bbst/persistent_red_black_tree_base.hpp
  - library/datastructure/segment_tree/persistent_lazy_segment_tree.hpp
  - library/datastructure/segment_tree/persistent_dual_segment_tree.hpp
  - library/datastructure/segment_tree/persistent_commutative_dual_segment_tree.hpp
  - library/datastructure/segment_tree/persistent_segment_tree.hpp
  timestamp: '2022-02-13 16:56:06+09:00'
  verificationStatus: LIBRARY_ALL_AC
  verifiedWith:
  - test/src/tree/link_cut_tree/lca.test.cpp
  - test/src/tree/link_cut_tree_path_foldable/lca.test.cpp
  - test/src/tree/link_cut_tree_path_foldable/dynamic_tree_vertex_set_path_composite.test.cpp
  - test/src/tree/link_cut_tree_path_foldable/dynamic_tree_vertex_add_path_sum.test.cpp
  - test/src/tree/link_cut_tree_path_foldable/dummy1.test.cpp
  - test/src/tree/link_cut_tree_path_foldable_lazy/GRL_5_E.test.cpp
  - test/src/tree/link_cut_tree_path_foldable_lazy/yuki399.test.cpp
  - test/src/tree/link_cut_tree_path_foldable_lazy/dummy1.test.cpp
  - test/src/datastructure/fenwick_tree/persistent_fenwick_tree/abc253_f.test.cpp
  - test/src/datastructure/fenwick_tree/persistent_fenwick_tree/rectangle_sum.test.cpp
  - test/src/datastructure/union_find/persistent_union_find/persistent_unionfind.test.cpp
  - test/src/datastructure/bbst/red_black_tree/abc237_d.test.cpp
  - test/src/datastructure/bbst/red_black_lazy_segment_tree/dynamic_sequence_range_affine_range_sum.test.cpp
  - test/src/datastructure/bbst/red_black_reversible_lazy_segment_tree/dynamic_sequence_range_affine_range_sum.test.cpp
  - test/src/datastructure/bbst/red_black_segment_tree/abc238_f.test.cpp
  - test/src/datastructure/segment_tree/persistent_dual_segment_tree/abc253.test.cpp
  - test/src/datastructure/segment_tree/persistent_commutative_dual_segment_tree/abc253.test.cpp
  - test/src/datastructure/segment_tree/persistent_segment_tree/abc253_f.test.cpp
  - test/src/datastructure/segment_tree/persistent_segment_tree/rectangle_sum.test.cpp
  - test/src/datastructure/segment_tree/persistent_segment_tree/dummy.test.cpp
  - test/src/datastructure/segment_tree/persistent_lazy_segment_tree/abc253.test.cpp
  - test/src/datastructure/segment_tree/persistent_lazy_segment_tree/dummy.test.cpp
documentation_of: library/util/object_pool.hpp
layout: document
title: Object Pool
---
## Object Pool