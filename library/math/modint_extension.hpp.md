---
data:
  _extendedDependsOn: []
  _extendedRequiredBy:
  - icon: ':heavy_check_mark:'
    path: library/convolution/array_subset_convolution.hpp
    title: Array Subset Convolution
  - icon: ':heavy_check_mark:'
    path: library/convolution/polynomial_eval_multipoint_eval.hpp
    title: "\u5217\u3092\u5909\u6570\u3068\u3057\u3066\u6301\u3064\u591A\u9805\u5F0F\
      \u306E\u8A55\u4FA1 (\u591A\u70B9\u8A55\u4FA1\u7248)"
  - icon: ':heavy_check_mark:'
    path: library/convolution/subset_convolution.hpp
    title: Subset Convolution
  - icon: ':heavy_check_mark:'
    path: library/math/array_sps.hpp
    title: Array Sps
  - icon: ':question:'
    path: library/math/product_of_differences.hpp
    title: Product Of Differences
  - icon: ':heavy_check_mark:'
    path: library/math/sps.hpp
    title: Set Power Series
  - icon: ':heavy_check_mark:'
    path: library/polynomial/array_fps_naive.hpp
    title: Array Fps Naive
  - icon: ':heavy_check_mark:'
    path: library/polynomial/bostan_mori.hpp
    title: Bostan Mori
  - icon: ':heavy_check_mark:'
    path: library/polynomial/common_sequences.hpp
    title: "\u6709\u540D\u306A\u6570\u5217\u305F\u3061"
  - icon: ':question:'
    path: library/polynomial/fps.hpp
    title: "\u5F62\u5F0F\u7684\u51AA\u7D1A\u6570"
  - icon: ':question:'
    path: library/polynomial/fps_naive.hpp
    title: "FFT-free \u306A\u5F62\u5F0F\u7684\u3079\u304D\u7D1A\u6570"
  - icon: ':x:'
    path: library/polynomial/lagrange_interpolation.hpp
    title: "\u30E9\u30B0\u30E9\u30F3\u30B8\u30E5\u88DC\u9593"
  - icon: ':question:'
    path: library/polynomial/multi_point_eval.hpp
    title: Multi Point Evaluation
  - icon: ':x:'
    path: library/polynomial/polynomial_interpolation.hpp
    title: "\u88DC\u9593\u591A\u9805\u5F0F"
  - icon: ':x:'
    path: library/polynomial/polynomial_taylor_shift.hpp
    title: Polynomial Taylor Shift
  - icon: ':x:'
    path: library/polynomial/subset_sum.hpp
    title: Subset Sum
  _extendedVerifiedWith:
  - icon: ':heavy_check_mark:'
    path: test/src/convolution/polynomial_eval_multipoint_eval/nim_counting.test.cpp
    title: test/src/convolution/polynomial_eval_multipoint_eval/nim_counting.test.cpp
  - icon: ':heavy_check_mark:'
    path: test/src/convolution/subset_convolution/subset_convolution.test.cpp
    title: test/src/convolution/subset_convolution/subset_convolution.test.cpp
  - icon: ':heavy_check_mark:'
    path: test/src/math/array_sps/abc213_g.test.cpp
    title: test/src/math/array_sps/abc213_g.test.cpp
  - icon: ':heavy_check_mark:'
    path: test/src/math/array_sps/abc236_h.test.cpp
    title: test/src/math/array_sps/abc236_h.test.cpp
  - icon: ':heavy_check_mark:'
    path: test/src/math/array_sps/abc253_h.test.cpp
    title: test/src/math/array_sps/abc253_h.test.cpp
  - icon: ':heavy_check_mark:'
    path: test/src/math/array_sps/abc253_h_2.test.cpp
    title: test/src/math/array_sps/abc253_h_2.test.cpp
  - icon: ':heavy_check_mark:'
    path: test/src/math/array_sps/arc105_f.test.cpp
    title: test/src/math/array_sps/arc105_f.test.cpp
  - icon: ':heavy_check_mark:'
    path: test/src/math/product_of_differences/yuki1938.test.cpp
    title: test/src/math/product_of_differences/yuki1938.test.cpp
  - icon: ':heavy_check_mark:'
    path: test/src/math/sps/abc213_g.test.cpp
    title: test/src/math/sps/abc213_g.test.cpp
  - icon: ':heavy_check_mark:'
    path: test/src/math/sps/abc236_h.test.cpp
    title: test/src/math/sps/abc236_h.test.cpp
  - icon: ':heavy_check_mark:'
    path: test/src/math/sps/abc253_h.test.cpp
    title: test/src/math/sps/abc253_h.test.cpp
  - icon: ':heavy_check_mark:'
    path: test/src/math/sps/abc253_h_2.test.cpp
    title: test/src/math/sps/abc253_h_2.test.cpp
  - icon: ':heavy_check_mark:'
    path: test/src/math/sps/arc105_f.test.cpp
    title: test/src/math/sps/arc105_f.test.cpp
  - icon: ':heavy_check_mark:'
    path: test/src/polynomial/bostan_mori/kth_term_of_linearly_recurrent_sequence.test.cpp
    title: test/src/polynomial/bostan_mori/kth_term_of_linearly_recurrent_sequence.test.cpp
  - icon: ':heavy_check_mark:'
    path: test/src/polynomial/common_sequences/abc247_h.test.cpp
    title: test/src/polynomial/common_sequences/abc247_h.test.cpp
  - icon: ':heavy_check_mark:'
    path: test/src/polynomial/common_sequences/bernoulli_number.test.cpp
    title: test/src/polynomial/common_sequences/bernoulli_number.test.cpp
  - icon: ':heavy_check_mark:'
    path: test/src/polynomial/common_sequences/montmort_number_mod.test.cpp
    title: test/src/polynomial/common_sequences/montmort_number_mod.test.cpp
  - icon: ':heavy_check_mark:'
    path: test/src/polynomial/common_sequences/partition_function.test.cpp
    title: test/src/polynomial/common_sequences/partition_function.test.cpp
  - icon: ':heavy_check_mark:'
    path: test/src/polynomial/common_sequences/stirling_number1.test.cpp
    title: test/src/polynomial/common_sequences/stirling_number1.test.cpp
  - icon: ':heavy_check_mark:'
    path: test/src/polynomial/common_sequences/stirling_number2.test.cpp
    title: test/src/polynomial/common_sequences/stirling_number2.test.cpp
  - icon: ':heavy_check_mark:'
    path: test/src/polynomial/fps/division_of_polynomials.test.cpp
    title: test/src/polynomial/fps/division_of_polynomials.test.cpp
  - icon: ':heavy_check_mark:'
    path: test/src/polynomial/fps/exp_of_formal_power_series_sparse.test.cpp
    title: test/src/polynomial/fps/exp_of_formal_power_series_sparse.test.cpp
  - icon: ':heavy_check_mark:'
    path: test/src/polynomial/fps/exp_of_fps.test.cpp
    title: test/src/polynomial/fps/exp_of_fps.test.cpp
  - icon: ':heavy_check_mark:'
    path: test/src/polynomial/fps/inv_of_formal_power_series_sparse.test.cpp
    title: test/src/polynomial/fps/inv_of_formal_power_series_sparse.test.cpp
  - icon: ':heavy_check_mark:'
    path: test/src/polynomial/fps/inv_of_fps.test.cpp
    title: test/src/polynomial/fps/inv_of_fps.test.cpp
  - icon: ':heavy_check_mark:'
    path: test/src/polynomial/fps/log_of_formal_power_series_sparse.test.cpp
    title: test/src/polynomial/fps/log_of_formal_power_series_sparse.test.cpp
  - icon: ':heavy_check_mark:'
    path: test/src/polynomial/fps/log_of_fps.test.cpp
    title: test/src/polynomial/fps/log_of_fps.test.cpp
  - icon: ':heavy_check_mark:'
    path: test/src/polynomial/fps/pow_of_formal_power_series_sparse.test.cpp
    title: test/src/polynomial/fps/pow_of_formal_power_series_sparse.test.cpp
  - icon: ':x:'
    path: test/src/polynomial/fps/pow_of_fps.test.cpp
    title: test/src/polynomial/fps/pow_of_fps.test.cpp
  - icon: ':heavy_check_mark:'
    path: test/src/polynomial/fps/sqrt_of_formal_power_series.test.cpp
    title: test/src/polynomial/fps/sqrt_of_formal_power_series.test.cpp
  - icon: ':heavy_check_mark:'
    path: test/src/polynomial/fps/sqrt_of_formal_power_series_sparse.test.cpp
    title: test/src/polynomial/fps/sqrt_of_formal_power_series_sparse.test.cpp
  - icon: ':x:'
    path: test/src/polynomial/fps_naive/abc245_d.test.cpp
    title: test/src/polynomial/fps_naive/abc245_d.test.cpp
  - icon: ':x:'
    path: test/src/polynomial/lagrange_interpolation/cumulative_sum.test.cpp
    title: test/src/polynomial/lagrange_interpolation/cumulative_sum.test.cpp
  - icon: ':x:'
    path: test/src/polynomial/lagrange_interpolation/dummy.test.cpp
    title: test/src/polynomial/lagrange_interpolation/dummy.test.cpp
  - icon: ':x:'
    path: test/src/polynomial/multi_point_eval/multi_point_evaluation.test.cpp
    title: test/src/polynomial/multi_point_eval/multi_point_evaluation.test.cpp
  - icon: ':x:'
    path: test/src/polynomial/polynomial_interpolation/polynomial_interpolation.test.cpp
    title: test/src/polynomial/polynomial_interpolation/polynomial_interpolation.test.cpp
  - icon: ':x:'
    path: test/src/polynomial/polynomial_taylor_shift/polynomial_taylor_shift.test.cpp
    title: test/src/polynomial/polynomial_taylor_shift/polynomial_taylor_shift.test.cpp
  - icon: ':x:'
    path: test/src/polynomial/subset_sum/p_subset_sum.test.cpp
    title: test/src/polynomial/subset_sum/p_subset_sum.test.cpp
  _isVerificationFailed: true
  _pathExtension: hpp
  _verificationStatusIcon: ':question:'
  attributes:
    links:
    - https://37zigen.com/tonelli-shanks-algorithm/
  bundledCode: "#line 1 \"library/math/modint_extension.hpp\"\n\n\n\n#include <cassert>\n\
    #include <optional>\n\n/**\n * refernce: https://37zigen.com/tonelli-shanks-algorithm/\n\
    \ * calculates x s.t. x^2 = a mod p in O((log p)^2).\n */\ntemplate <typename\
    \ mint>\nstd::optional<mint> optional_sqrt(mint a) {\n    static int p = mint::mod();\n\
    \    if (a == 0) return std::make_optional(0);\n    if (p == 2) return std::make_optional(a);\n\
    \    if (a.pow((p - 1) / 2) != 1) return std::nullopt;\n    mint b = 1;\n    while\
    \ (b.pow((p - 1) / 2) == 1) ++b;\n    static int tlz = __builtin_ctz(p - 1), q\
    \ = (p - 1) >> tlz;\n    mint x = a.pow((q + 1) / 2);\n    b = b.pow(q);\n   \
    \ for (int shift = 2; x * x != a; ++shift) {\n        mint e = a.inv() * x * x;\n\
    \        if (e.pow(1 << (tlz - shift)) != 1) x *= b;\n        b *= b;\n    }\n\
    \    return std::make_optional(x);\n}\n\n/**\n * calculates x s.t. x^2 = a mod\
    \ p in O((log p)^2).\n * if not exists, raises runtime error.\n */\ntemplate <typename\
    \ mint>\nauto sqrt(mint a) -> decltype(mint::mod(), mint()) {\n    return *optional_sqrt(a);\n\
    }\ntemplate <typename mint>\nauto log(mint a) -> decltype(mint::mod(), mint())\
    \  {\n    assert(a == 1);\n    return 0;\n}\ntemplate <typename mint>\nauto exp(mint\
    \ a) -> decltype(mint::mod(), mint())  {\n    assert(a == 0);\n    return 1;\n\
    }\ntemplate <typename mint, typename T>\nauto pow(mint a, T b) -> decltype(mint::mod(),\
    \ mint())  {\n    return a.pow(b);\n}\ntemplate <typename mint>\nauto inv(mint\
    \ a) -> decltype(mint::mod(), mint()) {\n    return a.inv();\n}\n\n\n"
  code: "#ifndef SUISEN_MODINT_EXTENSION\n#define SUISEN_MODINT_EXTENSION\n\n#include\
    \ <cassert>\n#include <optional>\n\n/**\n * refernce: https://37zigen.com/tonelli-shanks-algorithm/\n\
    \ * calculates x s.t. x^2 = a mod p in O((log p)^2).\n */\ntemplate <typename\
    \ mint>\nstd::optional<mint> optional_sqrt(mint a) {\n    static int p = mint::mod();\n\
    \    if (a == 0) return std::make_optional(0);\n    if (p == 2) return std::make_optional(a);\n\
    \    if (a.pow((p - 1) / 2) != 1) return std::nullopt;\n    mint b = 1;\n    while\
    \ (b.pow((p - 1) / 2) == 1) ++b;\n    static int tlz = __builtin_ctz(p - 1), q\
    \ = (p - 1) >> tlz;\n    mint x = a.pow((q + 1) / 2);\n    b = b.pow(q);\n   \
    \ for (int shift = 2; x * x != a; ++shift) {\n        mint e = a.inv() * x * x;\n\
    \        if (e.pow(1 << (tlz - shift)) != 1) x *= b;\n        b *= b;\n    }\n\
    \    return std::make_optional(x);\n}\n\n/**\n * calculates x s.t. x^2 = a mod\
    \ p in O((log p)^2).\n * if not exists, raises runtime error.\n */\ntemplate <typename\
    \ mint>\nauto sqrt(mint a) -> decltype(mint::mod(), mint()) {\n    return *optional_sqrt(a);\n\
    }\ntemplate <typename mint>\nauto log(mint a) -> decltype(mint::mod(), mint())\
    \  {\n    assert(a == 1);\n    return 0;\n}\ntemplate <typename mint>\nauto exp(mint\
    \ a) -> decltype(mint::mod(), mint())  {\n    assert(a == 0);\n    return 1;\n\
    }\ntemplate <typename mint, typename T>\nauto pow(mint a, T b) -> decltype(mint::mod(),\
    \ mint())  {\n    return a.pow(b);\n}\ntemplate <typename mint>\nauto inv(mint\
    \ a) -> decltype(mint::mod(), mint()) {\n    return a.inv();\n}\n\n#endif // SUISEN_MODINT_EXTENSION\n"
  dependsOn: []
  isVerificationFile: false
  path: library/math/modint_extension.hpp
  requiredBy:
  - library/math/product_of_differences.hpp
  - library/math/sps.hpp
  - library/math/array_sps.hpp
  - library/convolution/array_subset_convolution.hpp
  - library/convolution/polynomial_eval_multipoint_eval.hpp
  - library/convolution/subset_convolution.hpp
  - library/polynomial/multi_point_eval.hpp
  - library/polynomial/bostan_mori.hpp
  - library/polynomial/subset_sum.hpp
  - library/polynomial/lagrange_interpolation.hpp
  - library/polynomial/array_fps_naive.hpp
  - library/polynomial/fps.hpp
  - library/polynomial/polynomial_interpolation.hpp
  - library/polynomial/polynomial_taylor_shift.hpp
  - library/polynomial/common_sequences.hpp
  - library/polynomial/fps_naive.hpp
  timestamp: '2022-06-27 18:52:58+09:00'
  verificationStatus: LIBRARY_SOME_WA
  verifiedWith:
  - test/src/math/product_of_differences/yuki1938.test.cpp
  - test/src/math/array_sps/abc253_h_2.test.cpp
  - test/src/math/array_sps/arc105_f.test.cpp
  - test/src/math/array_sps/abc236_h.test.cpp
  - test/src/math/array_sps/abc253_h.test.cpp
  - test/src/math/array_sps/abc213_g.test.cpp
  - test/src/math/sps/abc253_h_2.test.cpp
  - test/src/math/sps/arc105_f.test.cpp
  - test/src/math/sps/abc236_h.test.cpp
  - test/src/math/sps/abc253_h.test.cpp
  - test/src/math/sps/abc213_g.test.cpp
  - test/src/convolution/subset_convolution/subset_convolution.test.cpp
  - test/src/convolution/polynomial_eval_multipoint_eval/nim_counting.test.cpp
  - test/src/polynomial/multi_point_eval/multi_point_evaluation.test.cpp
  - test/src/polynomial/polynomial_taylor_shift/polynomial_taylor_shift.test.cpp
  - test/src/polynomial/lagrange_interpolation/dummy.test.cpp
  - test/src/polynomial/lagrange_interpolation/cumulative_sum.test.cpp
  - test/src/polynomial/common_sequences/stirling_number2.test.cpp
  - test/src/polynomial/common_sequences/partition_function.test.cpp
  - test/src/polynomial/common_sequences/stirling_number1.test.cpp
  - test/src/polynomial/common_sequences/montmort_number_mod.test.cpp
  - test/src/polynomial/common_sequences/bernoulli_number.test.cpp
  - test/src/polynomial/common_sequences/abc247_h.test.cpp
  - test/src/polynomial/fps/sqrt_of_formal_power_series.test.cpp
  - test/src/polynomial/fps/log_of_fps.test.cpp
  - test/src/polynomial/fps/inv_of_formal_power_series_sparse.test.cpp
  - test/src/polynomial/fps/pow_of_formal_power_series_sparse.test.cpp
  - test/src/polynomial/fps/sqrt_of_formal_power_series_sparse.test.cpp
  - test/src/polynomial/fps/log_of_formal_power_series_sparse.test.cpp
  - test/src/polynomial/fps/inv_of_fps.test.cpp
  - test/src/polynomial/fps/pow_of_fps.test.cpp
  - test/src/polynomial/fps/exp_of_formal_power_series_sparse.test.cpp
  - test/src/polynomial/fps/exp_of_fps.test.cpp
  - test/src/polynomial/fps/division_of_polynomials.test.cpp
  - test/src/polynomial/bostan_mori/kth_term_of_linearly_recurrent_sequence.test.cpp
  - test/src/polynomial/subset_sum/p_subset_sum.test.cpp
  - test/src/polynomial/polynomial_interpolation/polynomial_interpolation.test.cpp
  - test/src/polynomial/fps_naive/abc245_d.test.cpp
documentation_of: library/math/modint_extension.hpp
layout: document
title: Modint Extension
---
## Modint Extension